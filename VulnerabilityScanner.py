#!/usr/bin/python
from socket import *
import os
import sys

filename = ''

def retBanner(ip,port):
    try:
        s = socket.socket()
        s.connect((ip,port))
        s.recv(1024)
        return banner
    except:
        return
        
def checkVulns(banner, filename):
    f = open(filename, "r")
    for line in f.readlines():
        if str(line.strip("\n")) in str(banner):
            print('(*) Service is Vulnerable: %s' % banner.strip("\n"))

def main():
    if len(sys.argv)== 2:
        filename = sys.argv[1]
        if not os.path.isfile(filename):
            print('(-) File Does Not Exist!')
            exit(0)
        if not os.access(filename, os.R_OK):
            print('(-) File Access is Denied!')
            exit(0)
    else:
        print('(*) Usage: %s' % sys.argv[0] + '<vulnerabilities filename>')
        exit(0)
    portlist = [80,443,445,4455,4445,4555,8080]
    for x in range(0,2):
        ip = '192.168.0.' + str(x)
    for port in portlist:
        banner = retBanner(ip,port)
        if(banner!=''):
            print('(*) %s' % ip)
            print('(*) %s' % banner)
            checkVulns(banner, filename)
main()
        
